import{addClass}from"./functions.min.js";const fixTwitterLink=()=>{const tweetLink=document.querySelector("#reactions .twitter-share-button");if(!tweetLink)return;const tweetUrl=new URL("https://twitter.com/intent/tweet");const postUrl=new URL(window.postUrl);const author=document.head.querySelector("meta[name='author']").content;const data={original_referer:`${postUrl.origin}`,text:document.title,url:postUrl.href,via:author};Object.keys(data).forEach(key=>{tweetUrl.searchParams.append(key,data[key])});tweetLink.href=tweetUrl.toString()};const loadReactions=async()=>{const reactions=await window.getReactions();const reactionsSection=document.getElementById("reactions");const availableReactions={like:{iconClass:["fas","fa-star","has-text-warning"]},repost:{iconClass:["fas","fa-retweet","has-text-success","ml-3"]},reply:{iconClass:["fas","fa-comment-dots","has-text-text","ml-3"]},mention:{iconClass:["fas","fa-quote-right","has-text-text","ml-3"],filter:"mention-of"}};const iconsDiv=document.createElement("div");addClass(iconsDiv,["reactions"]);Object.keys(availableReactions).forEach(key=>{const reactionCategory=availableReactions[key];const text=document.createTextNode(reactions.type[key]||0);const icon=document.createElement("i");addClass(icon,[...reactionCategory.iconClass,"mr-2"]);if(reactionCategory.filter&&reactions.type[key]){const link=document.createElement("a");link.href=`${window.mentionsUrl}&wm-property=${reactionCategory.filter}`;link.appendChild(icon);link.appendChild(text);iconsDiv.appendChild(link)}else{const span=document.createElement("span");span.appendChild(icon);span.appendChild(text);iconsDiv.appendChild(span)}});const flexDiv=reactionsSection.querySelector("div.flex");const lastReactions=flexDiv.querySelector("div.reactions");if(lastReactions){flexDiv.removeChild(lastReactions)}flexDiv.appendChild(iconsDiv)};document.addEventListener("turbo:load",()=>{fixTwitterLink();loadReactions()});